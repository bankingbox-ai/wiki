"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[784],{3905:(e,a,n)=>{n.d(a,{Zo:()=>c,kt:()=>g});var t=n(7294);function r(e,a,n){return a in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}function i(e,a){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);a&&(t=t.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),n.push.apply(n,t)}return n}function o(e){for(var a=1;a<arguments.length;a++){var n=null!=arguments[a]?arguments[a]:{};a%2?i(Object(n),!0).forEach((function(a){r(e,a,n[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))}))}return e}function s(e,a){if(null==e)return{};var n,t,r=function(e,a){if(null==e)return{};var n,t,r={},i=Object.keys(e);for(t=0;t<i.length;t++)n=i[t],a.indexOf(n)>=0||(r[n]=e[n]);return r}(e,a);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(t=0;t<i.length;t++)n=i[t],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=t.createContext({}),u=function(e){var a=t.useContext(l),n=a;return e&&(n="function"==typeof e?e(a):o(o({},a),e)),n},c=function(e){var a=u(e.components);return t.createElement(l.Provider,{value:a},e.children)},d="mdxType",p={inlineCode:"code",wrapper:function(e){var a=e.children;return t.createElement(t.Fragment,{},a)}},m=t.forwardRef((function(e,a){var n=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=u(n),m=r,g=d["".concat(l,".").concat(m)]||d[m]||p[m]||i;return n?t.createElement(g,o(o({ref:a},c),{},{components:n})):t.createElement(g,o({ref:a},c))}));function g(e,a){var n=arguments,r=a&&a.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=m;var s={};for(var l in a)hasOwnProperty.call(a,l)&&(s[l]=a[l]);s.originalType=e,s[d]="string"==typeof e?e:r,o[1]=s;for(var u=2;u<i;u++)o[u]=n[u];return t.createElement.apply(null,o)}return t.createElement.apply(null,n)}m.displayName="MDXCreateElement"},4084:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>l,contentTitle:()=>o,default:()=>p,frontMatter:()=>i,metadata:()=>s,toc:()=>u});var t=n(7462),r=(n(7294),n(3905));const i={title:"Cr\xf3nica de la elecci\xf3n de un sistema de integraci\xf3n continua",slug:"picking-cicd-system",authors:["benja"],tags:["tooling","guide"]},o=void 0,s={permalink:"/blog/picking-cicd-system",editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/2022-10-04-picking-cicd-system/index.md",source:"@site/blog/2022-10-04-picking-cicd-system/index.md",title:"Cr\xf3nica de la elecci\xf3n de un sistema de integraci\xf3n continua",description:"Durante las \xfaltimas semanas, decidimos trabajar en la ardua tarea de implementar un sistema de integraci\xf3n/despliegue continuo.",date:"2022-10-04T00:00:00.000Z",formattedDate:"4 de octubre de 2022",tags:[{label:"tooling",permalink:"/blog/tags/tooling"},{label:"guide",permalink:"/blog/tags/guide"}],readingTime:5.465,hasTruncateMarker:!0,authors:[{name:"Benjam\xedn Roa",title:"Desarrollador",url:"https://gitlab.com/broa",imageURL:"https://trello-members.s3.amazonaws.com/5e95bc4f2bc4ae1ad51b9dda/301e1a568b2b6527600023094f223b46/50.png",key:"benja"}],frontMatter:{title:"Cr\xf3nica de la elecci\xf3n de un sistema de integraci\xf3n continua",slug:"picking-cicd-system",authors:["benja"],tags:["tooling","guide"]},prevItem:{title:"Desarrollando con TDD, BDD, DDD \ud83e\udd72",permalink:"/blog/tdd-bdd-ddd"},nextItem:{title:"Flujo de trabajo de Lendaas",permalink:"/blog/lendaas-workflow"}},l={authorsImageUrls:[void 0]},u=[{value:"Qu\xe9 es un sistema de integraci\xf3n/despliegue continuo",id:"qu\xe9-es-un-sistema-de-integraci\xf3ndespliegue-continuo",level:2},{value:"Integraci\xf3n Continua (CI)",id:"integraci\xf3n-continua-ci",level:3},{value:"Despliegue Continuo (CD)",id:"despliegue-continuo-cd",level:3},{value:"Sistema de integraci\xf3n/despliegue continuo",id:"sistema-de-integraci\xf3ndespliegue-continuo",level:3},{value:"Por qu\xe9 es importante",id:"por-qu\xe9-es-importante",level:2},{value:"La b\xfasqueda",id:"la-b\xfasqueda",level:2},{value:"La promesa de AWS",id:"la-promesa-de-aws",level:3},{value:"CircleCi",id:"circleci",level:3},{value:"Amor a primera vista",id:"amor-a-primera-vista",level:4},{value:"Proof of Concept (POC)",id:"proof-of-concept-poc",level:4},{value:"Contratiempos",id:"contratiempos",level:4},{value:"Pros",id:"pros",level:4},{value:"Buddy",id:"buddy",level:3},{value:"Conclusiones y aprendizajes",id:"conclusiones-y-aprendizajes",level:2}],c={toc:u},d="wrapper";function p(e){let{components:a,...i}=e;return(0,r.kt)(d,(0,t.Z)({},c,i,{components:a,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"Durante las \xfaltimas semanas, decidimos trabajar en la ardua tarea de implementar un sistema de integraci\xf3n/despliegue continuo."),(0,r.kt)("p",null,"No ha sido un viaje libre de tropiezos, por aqu\xed\nles contamos el camino que recorrimos, las decisiones que fuimos tomando y a d\xf3nde llegamos."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"finding cicd",src:n(9478).Z,width:"1920",height:"1080"})),(0,r.kt)("h2",{id:"qu\xe9-es-un-sistema-de-integraci\xf3ndespliegue-continuo"},"Qu\xe9 es un sistema de integraci\xf3n/despliegue continuo"),(0,r.kt)("p",null,"M\xe1s conocidas por sus siglas en ingl\xe9s: Continuous Integration ","[CI]"," & Continuous Delivery ","[CD]",", son dos conceptos muy\nrelevantes para el desarrollo de software."),(0,r.kt)("h3",{id:"integraci\xf3n-continua-ci"},"Integraci\xf3n Continua (CI)"),(0,r.kt)("p",null,"Es la pr\xe1ctica de integrar nuevas l\xedneas de c\xf3digo de forma\n(muy) frecuente a un repositorio compartido. Acortar el\ntiempo que hay entre cada nuevo cambio del software\nevita la posibilidad de conflictos y nos obliga a mantener un nivel de\ncomunicaci\xf3n estrecho entre los desarrolladores del equipo."),(0,r.kt)("h3",{id:"despliegue-continuo-cd"},"Despliegue Continuo (CD)"),(0,r.kt)("p",null,"Tradicionalmente cuando un desarrollador terminaba algo, continuaba con una larga\nseguidilla de tareas que permit\xeda dejar esa nueva mejora en producci\xf3n. Este\nproceso pod\xeda incluir cosas como: probar el c\xf3digo localmente, empaquetar\nel c\xf3digo, autidarlo, desplegarlo en un ambiente pre-productivo, volver\na probarlo (manual y automatizadamente), pedir autorizaci\xf3n a otros,\ny, si vamos bien hasta ah\xed: desplegar en producci\xf3n."),(0,r.kt)("p",null,"El despliegue continuo se encarga de automatizar todo lo anterior para\nasegurar que los acuerdos t\xe9cnicos se cumplan de manera estandarizada y\nconsigamos llegar a producci\xf3n de la forma menos friccionada posible."),(0,r.kt)("p",null,"La premisa es: automatizar todo lo que sea automatizable."),(0,r.kt)("h3",{id:"sistema-de-integraci\xf3ndespliegue-continuo"},"Sistema de integraci\xf3n/despliegue continuo"),(0,r.kt)("p",null,"Por lo tanto un sistema de integraci\xf3n/delivery continuo es una serie de\nacuerdos, formas de trabajar y herramientas que nos permiten automatizar\nla forma en que nuestro c\xf3digo se transforma en una aplicaci\xf3n productiva."),(0,r.kt)("h2",{id:"por-qu\xe9-es-importante"},"Por qu\xe9 es importante"),(0,r.kt)("p",null,"Es fundamental tener un proceso aceitado, claro y transparente para todos\npor muchas razones, algunas de ellas:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Trabajamos con el ",(0,r.kt)("a",{parentName:"li",href:"https://www.less.works"},"Framework LeSS")," y queremos\nevitar a toda costa tener equipos a cargo de etapas de desarrollo (QA, DevOps, UX etc).\n",(0,r.kt)("a",{parentName:"li",href:"https://less.works/less/structure/teams#Donthavephase-basedresourceallocation"},"Aqu\xed"),"\npuedes leer m\xe1s acerca de las recomendaciones que tiene LeSS para sus equipos"),(0,r.kt)("li",{parentName:"ul"},"Queremos implementar ",(0,r.kt)("inlineCode",{parentName:"li"},"TDD")," como parte de nuestro flujo de trabajo para, ojal\xe1,\nliberar peque\xf1os incrementos diariamente. Contar con herramientas para que\nnuestro equipo pueda ver ese test fallando (\ud83d\udd34) y que su c\xf3digo sea llevado\ndirecto a producci\xf3n apenas sea posible, es parte importante de la metodolog\xeda"),(0,r.kt)("li",{parentName:"ul"},"Nos permite reducir nuestro CycleTime, medida importante de eficiencia para\nnuestros equipos"),(0,r.kt)("li",{parentName:"ul"},"Asegurar que se ejecuten las suites de tests y que se respeten\nlos acuerdos t\xe9cnicos del equipo"),(0,r.kt)("li",{parentName:"ul"},"Transparentar el historial completo de despliegues de nuestro software")),(0,r.kt)("h2",{id:"la-b\xfasqueda"},"La b\xfasqueda"),(0,r.kt)("p",null,"Desde este lugar, comenzamos nuestra b\xfasqueda."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"cicd benchmark",src:n(3938).Z,width:"1024",height:"558"})),(0,r.kt)("p",{align:"center"},"Tomado de: ",(0,r.kt)("a",{href:"https://katalon.com/resources-center/blog/ci-cd-tools"},"Katalon / Best 14 CI/CD Tools You Must Know | Updated for 2022")),(0,r.kt)("p",null,"Para salir adelante con la implementaci\xf3n de este tipo de herramientas\nno basta con leer art\xedculos y ver videos, hay que lanzarse a probar hasta\ndar con alguna soluci\xf3n que sea convincente."),(0,r.kt)("h3",{id:"la-promesa-de-aws"},"La promesa de AWS"),(0,r.kt)("p",null,"Fue la primera opci\xf3n que miramos seriamente, pensamos que era l\xf3gico que si usamos la nube de AWS\nnaturalmente podr\xedamos usar su sistema de integraci\xf3n continua de forma nativa."),(0,r.kt)("p",null,"C\xf3mo (parece que) funciona:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"A diferencia de nuestra experiencia con Drone, en AWS no existe la idea del ",(0,r.kt)("inlineCode",{parentName:"li"},"runner")," (una m\xe1quina que\nest\xe1 disponible para ejecutar trabajos ","[",(0,r.kt)("em",{parentName:"li"},"pipelines"),"]","), sino que es necesario crear una serie de recursos\nespec\xedficos que son orquestados en cada despliegue (",(0,r.kt)("inlineCode",{parentName:"li"},"AWS Pipelines"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"AWS CodeBuild"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"AWS CodeDeploy"),")"),(0,r.kt)("li",{parentName:"ul"},"La definici\xf3n de los pasos que ejecuta el ",(0,r.kt)("em",{parentName:"li"},"pipeline")," vivir\xeda en estos recursos de AWS"),(0,r.kt)("li",{parentName:"ul"},"Dado que queremos que la definici\xf3n del ",(0,r.kt)("em",{parentName:"li"},"stack")," viva en el mismo repositorio, desarrollamos los recursos\nde AWS y los desplegamos usando el ",(0,r.kt)("inlineCode",{parentName:"li"},"CLI")," de ",(0,r.kt)("inlineCode",{parentName:"li"},"SAM")," y ",(0,r.kt)("inlineCode",{parentName:"li"},"CloudFormation"))),(0,r.kt)("p",null,"Resultado:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"La interfaz del despliegue es tosca o no muy amigable"),(0,r.kt)("li",{parentName:"ul"},"El proceso es bastante m\xe1s lento de lo que era en Drone"),(0,r.kt)("li",{parentName:"ul"},"Si bien el potencial que tiene la herramienta es tremendo (b\xe1sicamente puedes orquestar cualquier\nservicio de AWS durante el proceso de despliegue), nos result\xf3 sumamente complicado y poco escalable\npara una organizaci\xf3n como la nuestra, donde son muchos los repositorios")),(0,r.kt)("p",null,"Finalmente decidimos seguir buscando."),(0,r.kt)("h3",{id:"circleci"},"CircleCi"),(0,r.kt)("h4",{id:"amor-a-primera-vista"},"Amor a primera vista"),(0,r.kt)("p",null,"Desde que comenzamos, la experiencia fue interesante. Conseguimos integrarnos y probar muy r\xe1pidamente.\nOfrece la posibilidad de usar ",(0,r.kt)("a",{parentName:"p",href:"https://circleci.com/docs/orb-intro"},"Orbs")," que parec\xedan simplificar bastante\nla especificaci\xf3n de pasos recurrentes (y puedes crear los tuyos!)."),(0,r.kt)("h4",{id:"proof-of-concept-poc"},"Proof of Concept (POC)"),(0,r.kt)("p",null,"Implementamos el siguiente flujo"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Al empujar en la rama principal arranca el pipeline"),(0,r.kt)("li",{parentName:"ul"},"Ejecuta an\xe1lisis est\xe1tico de c\xf3digo, revisa linters y test unitarios"),(0,r.kt)("li",{parentName:"ul"},"Despliega infraestructura en la cuenta personal de cada desarrollador"),(0,r.kt)("li",{parentName:"ul"},"Obtiene el output de la infraestructura creada y lo deja como variables de entorno"),(0,r.kt)("li",{parentName:"ul"},"Ejecuta test funcionales directamente contra la infraestructura que fue desplegada"),(0,r.kt)("li",{parentName:"ul"},"Independiente del resultado de los test funcionales, destruye la infraestructura"),(0,r.kt)("li",{parentName:"ul"},"Despliega en producci\xf3n")),(0,r.kt)("h4",{id:"contratiempos"},"Contratiempos"),(0,r.kt)("p",null,"Conseguimos sacar adelante la POC, pero no sin problemas."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"No fue f\xe1cil manejar ",(0,r.kt)("a",{parentName:"li",href:"https://circleci.com/docs/contexts"},"contextos")," espec\xedficos\npara manejar los secretos de cada desarrollador\n(finalmente llegamos a una especie de soluci\xf3n/hack)"),(0,r.kt)("li",{parentName:"ul"},"La integraci\xf3n de CircleCI con GitLab dejaba bastante que desear, algunas variables de\nentorno no exist\xedan, los filtros funcionaban err\xe1ticamente"),(0,r.kt)("li",{parentName:"ul"},"No pod\xedas entregarle el contexto con los secretos a varios de los orbs que provee\nCircleCI, como nuestra intenci\xf3n era desplegar en distintos entornos finalmente\ndesistimos de usar algunos Orbs que se ve\xedan prometedores"),(0,r.kt)("li",{parentName:"ul"},"Los ",(0,r.kt)("a",{parentName:"li",href:"https://circleci.com/docs/introduction-to-yaml-configurations#anchors-and-aliases"},"anchors"),"\nsi bien est\xe1n documentados, no parecen funcionar siempre. Obligados a repetir l\xedneas de c\xf3digo")),(0,r.kt)("h4",{id:"pros"},"Pros"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Permite modularizar l\xf3gica en peque\xf1os scripts que viven fuera de la definici\xf3n del template (",(0,r.kt)("inlineCode",{parentName:"li"},".sh")," o ",(0,r.kt)("inlineCode",{parentName:"li"},".js"),")"),(0,r.kt)("li",{parentName:"ul"},"Es realmente r\xe1pido, tiene una muy buena gesti\xf3n de contenedores pre-cargados e im\xe1genes optimizadas"),(0,r.kt)("li",{parentName:"ul"},"Puedes entregarle los informes de los test y crea estad\xedsticas muy interesantes acerca de su desempe\xf1o,\nidentifica ",(0,r.kt)("inlineCode",{parentName:"li"},"flaky test")," (test err\xe1ticos) y entrega bastante informaci\xf3n digerida para mejorar la estrategia\nde testing"),(0,r.kt)("li",{parentName:"ul"},"Entrega muchos detalles acerca de la gesti\xf3n de las m\xe1quinas que ejecutan los pipelines")),(0,r.kt)("h3",{id:"buddy"},"Buddy"),(0,r.kt)("p",null,"Hicimos una prueba sencilla y nos quedamos con las ganas de probarlo en profundidad. La interfaz\nse ve bastante buena y parece soportar bastantes servicios. Nos llam\xf3 la atenci\xf3n que ofrece un\nasistente muy completo para crear tu pipeline en el navegador, pero no entrega inmedi\xe1tamente\ndirectrices para implementar tu pipeline desde el c\xf3digo. Quiz\xe1 nos falt\xf3 tiempo."),(0,r.kt)("h2",{id:"conclusiones-y-aprendizajes"},"Conclusiones y aprendizajes"),(0,r.kt)("p",null,"Finalmente decidimos quedarnos con GitHub + CircleCI."),(0,r.kt)("p",null,"Existen muchas m\xe1s alternativas que no probamos, el panorama\nes extenso y queda bastante por investigar en este tema. Por\nahora estamos satisfechos con el resultado."))}p.isMDXComponent=!0},3938:(e,a,n)=>{n.d(a,{Z:()=>t});const t=n.p+"assets/images/Top-5-CICD-Tools-1024x558-95211391c1819d6f303906fd5f6ab3e4.webp"},9478:(e,a,n)=>{n.d(a,{Z:()=>t});const t=n.p+"assets/images/finding-cicd-7f84b2d9a3abde728d372e8583d83f23.png"}}]);